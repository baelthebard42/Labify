{"ast":null,"code":"import { compactVerify } from '../jws/compact/verify.js';\nimport jwtPayload from '../lib/jwt_claims_set.js';\nimport { JWTInvalid } from '../util/errors.js';\nexport async function jwtVerify(jwt, key, options) {\n  const verified = await compactVerify(jwt, key, options);\n  if (verified.protectedHeader.crit?.includes('b64') && verified.protectedHeader.b64 === false) {\n    throw new JWTInvalid('JWTs MUST NOT use unencoded payload');\n  }\n  const payload = jwtPayload(verified.protectedHeader, verified.payload, options);\n  const result = {\n    payload,\n    protectedHeader: verified.protectedHeader\n  };\n  if (typeof key === 'function') {\n    return {\n      ...result,\n      key: verified.key\n    };\n  }\n  return result;\n}","map":{"version":3,"names":["compactVerify","jwtPayload","JWTInvalid","jwtVerify","jwt","key","options","verified","protectedHeader","crit","includes","b64","payload","result"],"sources":["C:/Users/acer/Desktop/Projects/Labify/frontend/labifyfrontend/node_modules/jose/dist/browser/jwt/verify.js"],"sourcesContent":["import { compactVerify } from '../jws/compact/verify.js';\nimport jwtPayload from '../lib/jwt_claims_set.js';\nimport { JWTInvalid } from '../util/errors.js';\nexport async function jwtVerify(jwt, key, options) {\n    const verified = await compactVerify(jwt, key, options);\n    if (verified.protectedHeader.crit?.includes('b64') && verified.protectedHeader.b64 === false) {\n        throw new JWTInvalid('JWTs MUST NOT use unencoded payload');\n    }\n    const payload = jwtPayload(verified.protectedHeader, verified.payload, options);\n    const result = { payload, protectedHeader: verified.protectedHeader };\n    if (typeof key === 'function') {\n        return { ...result, key: verified.key };\n    }\n    return result;\n}\n"],"mappings":"AAAA,SAASA,aAAa,QAAQ,0BAA0B;AACxD,OAAOC,UAAU,MAAM,0BAA0B;AACjD,SAASC,UAAU,QAAQ,mBAAmB;AAC9C,OAAO,eAAeC,SAASA,CAACC,GAAG,EAAEC,GAAG,EAAEC,OAAO,EAAE;EAC/C,MAAMC,QAAQ,GAAG,MAAMP,aAAa,CAACI,GAAG,EAAEC,GAAG,EAAEC,OAAO,CAAC;EACvD,IAAIC,QAAQ,CAACC,eAAe,CAACC,IAAI,EAAEC,QAAQ,CAAC,KAAK,CAAC,IAAIH,QAAQ,CAACC,eAAe,CAACG,GAAG,KAAK,KAAK,EAAE;IAC1F,MAAM,IAAIT,UAAU,CAAC,qCAAqC,CAAC;EAC/D;EACA,MAAMU,OAAO,GAAGX,UAAU,CAACM,QAAQ,CAACC,eAAe,EAAED,QAAQ,CAACK,OAAO,EAAEN,OAAO,CAAC;EAC/E,MAAMO,MAAM,GAAG;IAAED,OAAO;IAAEJ,eAAe,EAAED,QAAQ,CAACC;EAAgB,CAAC;EACrE,IAAI,OAAOH,GAAG,KAAK,UAAU,EAAE;IAC3B,OAAO;MAAE,GAAGQ,MAAM;MAAER,GAAG,EAAEE,QAAQ,CAACF;IAAI,CAAC;EAC3C;EACA,OAAOQ,MAAM;AACjB"},"metadata":{},"sourceType":"module","externalDependencies":[]}